{# 
  H√âROS - SECTION PRINCIPALE
  =========================
  
  SYST√àME INTELLIGENT :
  ‚Ä¢ Donn√©es Tally (identity.json) + Placeholders m√©tier (trades.json)
  ‚Ä¢ Fallback automatique si donn√©es manquantes
  ‚Ä¢ Couleurs et textes adapt√©s au m√©tier
  ‚Ä¢ Logo intelligent : image si fournie, sinon nom d'entreprise
#}

{# D√©terminer le m√©tier : identity.TRADE ou site.trade #}
{% set currentTrade = identity.TRADE or site.trade or "depanneur" %}
{% set tradeData = trades[currentTrade] %}

{# Syst√®me de fallback pour chaque donn√©e #}
{% set heroText = identity.HERO_TEXT or tradeData.HERO_TITLE.replace("{{CITY}}", identity.CITY or "Votre ville") %}
{% set heroSubtitle = identity.HERO_SUBTITLE or "Intervention rapide, devis clair" %}
{% set aboutSnippet = identity.ABOUT_SNIPPET or tradeData.ABOUT_SNIPPET %}
{% set urgencyText = identity.URGENCY_TEXT or tradeData.URGENCY_TEXT %}
{% set accentColor = identity.ACCENT_COLOR or tradeData.ACCENT %}

{# Image de h√©ros : identity ou par m√©tier #}
{% if identity.HERO_BACKGROUND_IMAGE %}
  {% set heroBackgroundImage = identity.HERO_BACKGROUND_IMAGE %}
{% else %}
  {% set heroBackgroundImage = tradeData.HERO_IMAGE %}
{% endif %}

{# Appliquer la couleur d'accent du m√©tier #}
<style>
:root {
  --accent-color: {{ accentColor }};
  --hero-accent: {{ accentColor }};
}
</style>

{% if identity.ENABLE_EMERGENCY_BANNER %}
{# BANDEAU UNIFI√â - M√äME ANIMATION PARTOUT #}
<div class="unified-emergency-banner" style="background: {{ accentColor }}; color: white; padding: 0.5rem 0; text-align: center; font-weight: bold; position: sticky; top: 0; z-index: 1000; border-bottom: 3px solid {{ accentColor }}cc;">
  <div class="slogan-rotator">
    {% set slogans = tradeData.URGENCY_SLOGANS or [urgencyText, "Intervention rapide 24h/24", "Service professionnel garanti"] %}
    {% for slogan in slogans %}
      <span class="rotating-slogan" data-index="{{ loop.index0 }}">{{ slogan }}</span>
    {% endfor %}
  </div>
</div>

<style>
/* ANIMATION UNIQUE POUR TOUS LES √âCRANS */
.slogan-rotator {
  position: relative;
  height: 1.5em;
  overflow: hidden;
}

.rotating-slogan {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  opacity: 0;
  animation: fadeInOut 9s infinite;
}

.rotating-slogan[data-index="0"] { 
  animation-delay: 0s; 
  opacity: 1;
  transform: translateY(0) scale(1);
}
.rotating-slogan[data-index="1"] { animation-delay: 3s; }
.rotating-slogan[data-index="2"] { animation-delay: 6s; }

@keyframes fadeInOut {
  0%, 30% { opacity: 1; }
  33%, 100% { opacity: 0; }
}

/* TRUST BADGES STYL√âS */
.trust-badges {
  display: flex;
  gap: 0.5rem;
  flex-wrap: wrap;
  justify-content: center;
  margin: 1rem 0;
}

.trust-badge {
  display: inline-flex;
  align-items: center;
  gap: 0.3rem;
  padding: 0.4rem 0.8rem;
  border-radius: 20px;
  font-size: 0.85rem;
  font-weight: 500;
  backdrop-filter: blur(5px);
  transition: all 0.2s ease;
}

.trust-badge:hover {
  transform: translateY(-1px);
  background: rgba(255, 255, 255, 0.3) !important;
  border: 1px solid rgba(255, 255, 255, 0.5) !important;
}

.badge-icon {
  font-weight: bold;
  font-size: 0.9rem;
}

/* BOUTON SECONDAIRE GLASSMORPHISM */
.cta-secondary:hover {
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.3), {{ accentColor }}30) !important;
  border: 1px solid {{ accentColor }}60 !important;
  transform: translateY(-1px);
}

/* RESPONSIVE - M√äME ANIMATION, JUSTE TAILLE ADAPT√âE */
@media (max-width: 768px) {
  .unified-emergency-banner {
    font-size: 0.85rem;
    padding: 0.4rem 0;
  }
  
  .slogan-rotator {
    height: 1.3em;
  }
  
  .trust-badges {
    gap: 0.3rem;
  }
  
  .trust-badge {
    font-size: 0.8rem;
    padding: 0.3rem 0.6rem;
  }
}
</style>
{% endif %}

<header class="hero{% if heroBackgroundImage %} has-bg-image{% endif %}" 
        style="{% if heroBackgroundImage %}--hero-bg-image: url('{{ heroBackgroundImage }}');{% endif %} --accent-color: {{ accentColor }};">
  <div class="container">
    <div class="hero-logo">
      {% set hasRealLogo = identity.LOGO_URL and not identity.LOGO_URL.includes('/assets/images/logo.png') %}
      {% if hasRealLogo %}
      <img src="{{ identity.LOGO_URL }}" alt="{{ identity.BUSINESS_NAME }}" class="logo">
      {% else %}
      <h2 class="business-name">{{ identity.BUSINESS_NAME }}</h2>
      {% endif %}
    </div>
    
    <h1>{{ heroText }}</h1>
    <p class="hero-subtitle">{{ heroSubtitle }}</p>
    <p class="hero-description">{{ aboutSnippet }}</p>
    
    <div class="cta-row">
      {% set tel = identity.PHONE_TEL or identity.CTA_PRIMARY_TEL %}
      {% if tel %}
      <a class="cta-primary" href="tel:{{ tel }}" style="background: {{ accentColor }}cc; backdrop-filter: blur(10px);">
        <span class="cta-icon">üìû</span>
        <span class="cta-text">
          <span class="cta-phone">{{ identity.PHONE_PRETTY or tel }}</span>
          <span class="cta-label">{{ identity.CTA_PRIMARY_TEXT }}</span>
        </span>
      </a>
      {% endif %}
      <a class="cta-secondary" href="mailto:{{ identity.EMAIL }}" style="background: rgba(255, 255, 255, 0.15); border: 2px solid {{ accentColor }}88; backdrop-filter: blur(10px);">
        ‚úâÔ∏è {{ identity.CTA_SECONDARY_TEXT }}
      </a>
    </div>
    
    {% if identity.TRUST_BADGES %}
    <div class="trust-badges">
      {% for badge in identity.TRUST_BADGES %}
      <span class="trust-badge" style="background: rgba(255, 255, 255, 0.2); border: 1px solid rgba(255, 255, 255, 0.3); color: white; text-shadow: 0 1px 2px rgba(0,0,0,0.5);">
        <span class="badge-icon" style="color: {{ accentColor }};">‚úì</span>
        {{ badge }}
      </span>
      {% endfor %}
    </div>
    {% endif %}
    
    {% if identity.IS_24_7 %}
    <p class="availability" style="background: rgba(255, 255, 255, 0.2); border: 1px solid rgba(255, 255, 255, 0.3); color: white; padding: 0.4rem 1rem; border-radius: 20px; display: inline-block; font-weight: 500; text-shadow: 0 1px 2px rgba(0,0,0,0.5);">
      üïê Disponible 24/7 - {{ identity.RESPONSE_TIME }}
    </p>
    {% endif %}
    
  </div>
</header>

